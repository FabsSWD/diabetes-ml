from flask import Flask, request, jsonify
from tensorflow.keras.models import load_model
import pandas as pd
import numpy as np
import os

app = Flask(__name__)

# Ruta del modelo guardado
model_save_path = "/content/drive/MyDrive/Python/MLDiabetes/diabetes_prediction_model.keras"
loaded_model = load_model(model_save_path)

# Ruta para la predicciÃ³n
@app.route('/predict', methods=['POST'])
def predict():
    try:
        input_data = request.json['input_data']
        input_df = pd.DataFrame([input_data], columns=['Pregnancies', 'Glucose', 'BloodPressure', 'SkinThickness', 'Insulin', 'BMI', 'DiabetesPedigreeFunction', 'Age'])
        scaled_input = scaler.transform(input_df.to_numpy())
        scaled_input = imputer.transform(scaled_input)
        prediction = loaded_model.predict(scaled_input)[0][0] >= 0.5
        return jsonify({'prediction': prediction})
    except Exception as e:
        return jsonify({'error': str(e)})

if __name__ == '__main__':
    app.run(debug=True, host='0.0.0.0', port=5000)
